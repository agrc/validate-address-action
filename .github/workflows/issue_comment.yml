name: Issue Comment Events

on:
  issue_comment:
    types: [created]

permissions:
  issues: write
  contents: read

jobs:
  test:
    name: ğŸ“ Geocode addresses
    runs-on: ubuntu-latest
    environment: prod
    steps:
      - name: Add emoji to comment
        uses: actions/github-script@v7
        with:
          script: |
            const comment = context.payload.comment;
            const body = comment.body;

            if (!body.startsWith('/validate addresses')) {
              return;
            }

             github.rest.reactions.createForIssueComment({
                owner: context.repo.owner,
                repo: context.repo.repo,
                comment_id: context.payload.comment.id,
                content: 'eyes'
              });

      - name: â¬‡ï¸ Set up code
        uses: actions/checkout@v4
        with:
          show-progress: false

      - name: ï¿½ Setup PNPM
        uses: pnpm/action-setup@v4
        with:
          version: latest

      - name: â” Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: lts/*
          cache: pnpm

      - name: ï¿½ğŸ“¥ Download dependencies
        run: pnpm install

      - name: ğŸ— Run build command
        run: pnpm run build

      - name: ğŸ§ª Test action
        uses: ./
        with:
          API_KEY: ${{ secrets.API_KEY }}
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
